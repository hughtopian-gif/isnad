<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Isnad â€” Live Stats Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a0a0a; color: #e0e0e0; line-height: 1.6; }
        .container { max-width: 1000px; margin: 0 auto; padding: 0 20px; }
        header { padding: 20px 0; border-bottom: 1px solid #222; }
        .logo { font-size: 24px; font-weight: bold; color: #00d4aa; text-decoration: none; }
        .logo span { color: #e01b24; }
        h1 { font-size: 36px; margin: 40px 0 10px; background: linear-gradient(135deg, #00d4aa, #4a9eff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .subtitle { color: #666; margin-bottom: 30px; }
        .live-dot { display: inline-block; width: 8px; height: 8px; background: #00d4aa; border-radius: 50%; margin-right: 8px; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: #111; border: 1px solid #222; border-radius: 12px; padding: 25px; text-align: center; }
        .stat-value { font-size: 42px; font-weight: bold; color: #fff; }
        .stat-value.green { color: #00d4aa; }
        .stat-value.red { color: #e01b24; }
        .stat-value.blue { color: #4a9eff; }
        .stat-value.yellow { color: #f5c211; }
        .stat-label { color: #888; font-size: 14px; margin-top: 5px; text-transform: uppercase; letter-spacing: 1px; }
        .chart-section { background: #111; border: 1px solid #222; border-radius: 12px; padding: 30px; margin-bottom: 30px; }
        .chart-title { font-size: 18px; margin-bottom: 20px; color: #fff; }
        .bar-chart { display: flex; align-items: flex-end; justify-content: space-between; height: 200px; gap: 10px; }
        .bar-container { flex: 1; display: flex; flex-direction: column; align-items: center; height: 100%; }
        .bar { width: 100%; max-width: 60px; background: linear-gradient(180deg, #00d4aa, #008866); border-radius: 6px 6px 0 0; min-height: 4px; }
        .bar-label { color: #666; font-size: 12px; margin-top: 10px; text-align: center; }
        .bar-value { color: #00d4aa; font-size: 14px; font-weight: bold; margin-bottom: 8px; }
        .risk-breakdown { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }
        .risk-item { display: flex; align-items: center; gap: 12px; padding: 15px; background: #0a0a0a; border-radius: 8px; }
        .risk-dot { width: 12px; height: 12px; border-radius: 50%; }
        .risk-dot.clean { background: #00d4aa; }
        .risk-dot.low { background: #97ca00; }
        .risk-dot.medium { background: #f5c211; }
        .risk-dot.high { background: #fe7d37; }
        .risk-dot.critical { background: #e01b24; }
        .risk-name { color: #888; flex: 1; }
        .risk-count { font-weight: bold; color: #fff; }
        footer { padding: 40px 0; border-top: 1px solid #222; text-align: center; color: #666; margin-top: 40px; }
        footer a { color: #00d4aa; text-decoration: none; }
        .loading { text-align: center; padding: 60px; color: #666; }
        .nav { float: right; }
        .nav a { color: #888; text-decoration: none; margin-left: 20px; }
        .nav a:hover { color: #00d4aa; }
    </style>
</head>
<body>
    <header><div class="container"><a href="/" class="logo">ðŸ”± isnad<span>.dev</span></a><nav class="nav"><a href="/docs">API Docs</a><a href="/stats.html" style="color: #00d4aa;">Stats</a></nav></div></header>
    <div class="container">
        <h1>ðŸ“Š Live Stats</h1>
        <p class="subtitle"><span class="live-dot"></span>Auto-refreshes every 30 seconds</p>
        <div id="dashboard"><div class="loading">Loading stats...</div></div>
    </div>
    <footer><div class="container"><p>Built by <a href="https://moltbook.com/u/H. Evans</p><p style="margin-top: 10px;"><a href="/">Home</a> Â· <a href="/docs">API Docs</a></p></div></footer>
    <script>
        async function loadStats() {
            try {
                const response = await fetch('/api/v1/stats');
                const stats = await response.json();
                const maxDaily = Math.max(...stats.daily_last_7_days.map(d => d.count), 1);
                document.getElementById('dashboard').innerHTML = '<div class="stats-grid"><div class="stat-card"><div class="stat-value blue">'+stats.total_scans+'</div><div class="stat-label">Total Scans</div></div><div class="stat-card"><div class="stat-value green">'+stats.today+'</div><div class="stat-label">Today</div></div><div class="stat-card"><div class="stat-value">'+stats.this_week+'</div><div class="stat-label">This Week</div></div><div class="stat-card"><div class="stat-value red">'+stats.threats_detected+'</div><div class="stat-label">Threats Detected</div></div><div class="stat-card"><div class="stat-value yellow">'+stats.unique_users+'</div><div class="stat-label">Unique Users</div></div><div class="stat-card"><div class="stat-value">'+stats.this_month+'</div><div class="stat-label">This Month</div></div></div><div class="chart-section"><div class="chart-title">ðŸ“ˆ Scans - Last 7 Days</div><div class="bar-chart">'+stats.daily_last_7_days.map(function(day){var h=(day.count/maxDaily)*160+4;var d=new Date(day.date);return '<div class="bar-container"><div class="bar-value">'+day.count+'</div><div style="flex:1;display:flex;align-items:flex-end;width:100%"><div class="bar" style="height:'+h+'px"></div></div><div class="bar-label">'+d.toLocaleDateString("en-US",{weekday:"short"})+'<br>'+d.getDate()+'</div></div>';}).join('')+'</div></div><div class="chart-section"><div class="chart-title">ðŸŽ¯ Risk Level Breakdown</div><div class="risk-breakdown"><div class="risk-item"><div class="risk-dot clean"></div><span class="risk-name">Clean</span><span class="risk-count">'+(stats.by_risk_level.clean||0)+'</span></div><div class="risk-item"><div class="risk-dot low"></div><span class="risk-name">Low</span><span class="risk-count">'+(stats.by_risk_level.low||0)+'</span></div><div class="risk-item"><div class="risk-dot medium"></div><span class="risk-name">Medium</span><span class="risk-count">'+(stats.by_risk_level.medium||0)+'</span></div><div class="risk-item"><div class="risk-dot high"></div><span class="risk-name">High</span><span class="risk-count">'+(stats.by_risk_level.high||0)+'</span></div><div class="risk-item"><div class="risk-dot critical"></div><span class="risk-name">Critical</span><span class="risk-count">'+(stats.by_risk_level.critical||0)+'</span></div></div></div><p style="text-align:center;color:#444;font-size:12px">Last updated: '+new Date(stats.generated_at).toLocaleString()+'</p>';
            } catch (e) { document.getElementById('dashboard').innerHTML = '<div style="color:#e01b24;text-align:center;padding:40px">Failed to load stats</div>'; }
        }
        loadStats();
        setInterval(loadStats, 30000);
    </script>
</body>
</html>
